# OpenAI API Curl Requests for Trading System
# Replace YOUR_API_KEY with your actual OpenAI API key

# ============================================
# 1. NUMERIC ANALYSIS CALL (Every 5 minutes)
# ============================================

curl -X POST https://api.openai.com/v1/chat/completions \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "gpt-4o",
    "messages": [
      {
        "role": "system",
        "content": "You are a rapid MTF scalping/risk analyzer. You will receive compact numeric features every 5 minutes. Output one minified JSON line matching this schema: {\"sym\":int,\"t\":int,\"p\":float,\"tf\":[...],\"s\":[...],\"c\":[...],\"o\":[...],\"f\":[...],\"conf\":[...],\"sA\":int,\"fA\":int,\"confA\":int,\"prob_cont\":int,\"sc_in\":int,\"sc_out\":int,\"hold\":int,\"tp_atr\":float,\"sl_atr\":float,\"hedge\":int,\"reasons\":[int,...]}"
      },
      {
        "role": "user",
        "content": "sym=3 t=1724578800 p=42.8 exec_tf=5 TF=[10080,1440,240,60,15,5] px_z=[0.2,-0.3,-0.1,0.1,0.3,0.4] v_z=[0.5,0.4,0.2,0.8,1.2,1.5] vwap_z=[-0.1,0.0,0.2,0.3,0.8,1.4] cvd_s=[0.1,0.05,-0.02,0.08,0.12,0.18] oi_d=[0.02,0.01,0.00,0.03,0.05,0.06] liq_n=[0.8,0.9,1.0,1.1,1.2,1.3] reg=[0,0,1,1,1,1] L_sup=42.3 L_res=43.1 L_q_bid=2.1 L_q_ask=3.4 L_dsup=0.7 L_dres=0.9 basis_bp=6.5 fund_bp=1.2 px_disp_bp=1.1 pos=0.75 avg=42.5 unrlz=0.71 rsk=2 hr12=0.58 slip_bp=2.1 dd_pct=1.9"
      }
    ],
    "temperature": 0.1,
    "max_tokens": 200
  }'


# ============================================
# 2. VISUAL AUDIT CALL (Every 1 hour) 
# ============================================

# Note: Replace IMAGE_BASE64_DATA with actual base64 encoded image
curl -X POST https://api.openai.com/v1/chat/completions \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "gpt-4o",
    "messages": [
      {
        "role": "system",
        "content": "You are a trading auditor. You will receive one chart image (CVD/OI/price/VWAP) plus a compact numeric summary. Compare them and return one minified JSON line with audit results matching this schema: {\"sym\":int,\"t\":int,\"p\":float,\"numeric_ok\":int,\"visual_confirms\":int,\"notes\":string}"
      },
      {
        "role": "user",
        "content": [
          {
            "type": "text",
            "text": "sym=3 t=1724578800 p=42.8 cvd_s5=0.18 cvd_div=0 oi_d3=0.06 prob_cont=78"
          },
          {
            "type": "image_url",
            "image_url": {
              "url": "data:image/png;base64,IMAGE_BASE64_DATA"
            }
          }
        ]
      }
    ],
    "temperature": 0.1,
    "max_tokens": 150
  }'


# ============================================
# 3. SIMPLE TEST CALL
# ============================================

curl -X POST https://api.openai.com/v1/chat/completions \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "gpt-4o-mini",
    "messages": [
      {
        "role": "user",
        "content": "Test connection"
      }
    ],
    "max_tokens": 10
  }'


# ============================================
# WINDOWS POWERSHELL VERSION
# ============================================

# For Windows PowerShell, use this format:
curl.exe -X POST https://api.openai.com/v1/chat/completions `
  -H "Authorization: Bearer YOUR_API_KEY" `
  -H "Content-Type: application/json" `
  -d "{`"model`":`"gpt-4o`",`"messages`":[{`"role`":`"user`",`"content`":`"Test`"}],`"max_tokens`":10}"


# ============================================
# NOTES
# ============================================

# 1. The API uses the standard OpenAI Chat Completions endpoint
# 2. Models available: gpt-4o, gpt-4o-mini, gpt-4-turbo, gpt-3.5-turbo
# 3. For production, consider using:
#    - temperature: 0.1 (for consistent outputs)
#    - max_tokens: limit based on expected response size
#    - response_format: {"type": "json_object"} for guaranteed JSON output
# 4. Image inputs must be base64 encoded or URL references
# 5. Rate limits apply based on your OpenAI tier